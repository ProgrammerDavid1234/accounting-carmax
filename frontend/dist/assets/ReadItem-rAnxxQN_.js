import{aq as L,ap as O,ai as B,a as l,ah as e}from"./index-DICNmN0G.js";import{P as F}from"./index-DrLm12-t.js";import{D as M,B as c,Q as W,a1 as q,O as Q,X as j,W as g,V as r}from"./IdurarOs-DQIhGZkQ.js";import{e as S}from"./actions-D2x6ggdI.js";import{s as d}from"./index-KrFx5yLV.js";import{c as H}from"./selectors-CA_LF2fK.js";import{u as A}from"./useDate-DxSV4nP-.js";import{u as U}from"./useMail-PVKNdHdu.js";import{t as b}from"./statusTagColor-DxbKI3gy.js";import{T as v}from"./index-DdZSsGFA.js";import{R as V}from"./RetweetOutlined-DOe0v2Gz.js";import{S as p}from"./index-CEilWfhF.js";import{D as h}from"./index-XZ65j9Ez.js";import{C as X}from"./CloseCircleOutlined-DOxxBXXR.js";import{F as Y}from"./FilePdfOutlined-WRwlQbGe.js";const z=({item:n,currentErp:u})=>{const{moneyFormatter:s}=A();return e.jsxs(j,{gutter:[12,0],children:[e.jsxs(r,{className:"gutter-row",span:11,children:[e.jsx("p",{style:{marginBottom:5},children:e.jsx("strong",{children:n.itemName})}),e.jsx("p",{children:n.description})]}),e.jsx(r,{className:"gutter-row",span:4,children:e.jsx("p",{style:{textAlign:"right"},children:s({amount:n.price,currency_code:u.currency})})}),e.jsx(r,{className:"gutter-row",span:4,children:e.jsx("p",{style:{textAlign:"right"},children:n.quantity})}),e.jsx(r,{className:"gutter-row",span:5,children:e.jsx("p",{style:{textAlign:"right",fontWeight:"700"},children:s({amount:n.total,currency_code:u.currency})})}),e.jsx(g,{dashed:!0,style:{marginTop:0,marginBottom:15}})]},n._id)};function ue({config:n,selectedItem:u}){var _,$;const s=M(),{entity:a,ENTITY_NAME:E}=n,N=L(),y=O(),{moneyFormatter:i}=A(),{send:I,isLoading:R}=U({entity:a}),{result:m}=B(H),T={status:"",client:{name:"",email:"",phone:"",address:""},subTotal:0,taxTotal:0,taxRate:0,total:0,credit:0,number:0,year:0},[D,f]=l.useState([]),[t,w]=l.useState(u??T),[C,P]=l.useState({});return l.useEffect(()=>{if(m){const{items:o,invoice:x,...k}=m;o?(f(o),w(m)):x.items&&(f(x.items),w({...x.items,...k,...x}))}return()=>{f([]),w(T)}},[m]),l.useEffect(()=>{t!=null&&t.client&&P(t.client[t.client.type])},[t]),e.jsxs(e.Fragment,{children:[e.jsx(F,{onBack:()=>{y(`/${a.toLowerCase()}`)},title:`${E} # ${t.number}/${t.year||""}`,ghost:!1,tags:[e.jsx(v,{color:(_=b(t.status))==null?void 0:_.color,children:t.status&&s(t.status)},"status"),t.paymentStatus&&e.jsx(v,{color:($=b(t.paymentStatus))==null?void 0:$.color,children:t.paymentStatus&&s(t.paymentStatus)},"paymentStatus")],extra:[e.jsx(c,{onClick:()=>{y(`/${a.toLowerCase()}`)},icon:e.jsx(X,{}),children:s("Close")},`${d.generate()}`),e.jsx(c,{onClick:()=>{window.open(`${W}${a}/${a}-${t._id}.pdf`,"_blank")},icon:e.jsx(Y,{}),children:s("Download PDF")},`${d.generate()}`),e.jsx(c,{loading:R,onClick:()=>{I(t._id)},icon:e.jsx(q,{}),children:s("Send by Email")},`${d.generate()}`),e.jsx(c,{onClick:()=>{N(S.convert({entity:a,id:t._id}))},icon:e.jsx(V,{}),style:{display:a==="quote"?"inline-block":"none"},children:s("Convert to Invoice")},`${d.generate()}`),e.jsx(c,{onClick:()=>{N(S.currentAction({actionType:"update",data:t})),y(`/${a.toLowerCase()}/update/${t._id}`)},type:"primary",icon:e.jsx(Q,{}),children:s("Edit")},`${d.generate()}`)],style:{padding:"20px 0px"},children:e.jsxs(j,{children:[e.jsx(p,{title:"Status",value:t.status}),e.jsx(p,{title:s("SubTotal"),value:i({amount:t.subTotal,currency_code:t.currency}),style:{margin:"0 32px"}}),e.jsx(p,{title:s("Total"),value:i({amount:t.total,currency_code:t.currency}),style:{margin:"0 32px"}}),e.jsx(p,{title:s("Paid"),value:i({amount:t.credit,currency_code:t.currency}),style:{margin:"0 32px"}})]})}),e.jsx(g,{dashed:!0}),e.jsxs(h,{title:`Client : ${t.client.name}`,children:[e.jsx(h.Item,{label:s("Address"),children:C.address}),e.jsx(h.Item,{label:s("email"),children:C.email}),e.jsx(h.Item,{label:s("Phone"),children:C.phone})]}),e.jsx(g,{}),e.jsxs(j,{gutter:[12,0],children:[e.jsx(r,{className:"gutter-row",span:11,children:e.jsx("p",{children:e.jsx("strong",{children:s("Product")})})}),e.jsx(r,{className:"gutter-row",span:4,children:e.jsx("p",{style:{textAlign:"right"},children:e.jsx("strong",{children:s("Price")})})}),e.jsx(r,{className:"gutter-row",span:4,children:e.jsx("p",{style:{textAlign:"right"},children:e.jsx("strong",{children:s("Quantity")})})}),e.jsx(r,{className:"gutter-row",span:5,children:e.jsx("p",{style:{textAlign:"right"},children:e.jsx("strong",{children:s("Total")})})}),e.jsx(g,{})]}),D.map(o=>e.jsx(z,{item:o,currentErp:t},o._id)),e.jsx("div",{style:{width:"300px",float:"right",textAlign:"right",fontWeight:"700"},children:e.jsxs(j,{gutter:[12,-5],children:[e.jsx(r,{className:"gutter-row",span:12,children:e.jsxs("p",{children:[s("Sub Total")," :"]})}),e.jsx(r,{className:"gutter-row",span:12,children:e.jsx("p",{children:i({amount:t.subTotal,currency_code:t.currency})})}),e.jsx(r,{className:"gutter-row",span:12,children:e.jsxs("p",{children:[s("Tax Total")," (",t.taxRate," %) :"]})}),e.jsx(r,{className:"gutter-row",span:12,children:e.jsx("p",{children:i({amount:t.taxTotal,currency_code:t.currency})})}),e.jsx(r,{className:"gutter-row",span:12,children:e.jsxs("p",{children:[s("Total")," :"]})}),e.jsx(r,{className:"gutter-row",span:12,children:e.jsx("p",{children:i({amount:t.total,currency_code:t.currency})})})]})})]})}export{ue as R};
