import{ah as e,aq as N,ar as _,ap as E,a as I,ai as L,aw as $}from"./index-HnWu2ajL.js";import{Z as A,D}from"./IdurarOs-BukodILd.js";import"./index-EdnPnSX_.js";import{s as b,E as f}from"./selectors-CanXvmAz.js";import{e as v}from"./actions-ClqYLQbb.js";function R({config:r,selectedItem:i}){var m;const s=useLanguage(),{entity:n,ENTITY_NAME:d}=r,u=useDispatch(),{moneyFormatter:a}=useMoney(),h=useNavigate(),[x,y]=useState({}),{result:l}=useSelector(selectCurrentItem),T={status:"",lead:{name:"",email:"",phone:"",address:""},subTotal:0,taxTotal:0,taxRate:0,total:0,credit:0,number:0,year:0},[C,j]=useState([]),[t,p]=useState(i??T);return useEffect(()=>{const o=new AbortController;if(l){const{items:g,invoice:c,...w}=l;g?(j(g),p(l)):c.items&&(j(c.items),p({...c.items,...w,...c}))}return()=>o.abort()},[l]),useEffect(()=>{t!=null&&t.lead&&y(t.lead[t.lead.type])},[t]),e.jsxs(e.Fragment,{children:[e.jsx(PageHeader,{onBack:()=>{h(`/${n.toLowerCase()}`)},title:`${d} # ${t.number}/${t.year||""}`,ghost:!1,tags:e.jsx(Tag,{color:(m=tagColor(t.status))==null?void 0:m.color,children:s(t.status)}),extra:[e.jsx(Button,{onClick:()=>{h(`/${n.toLowerCase()}`)},icon:e.jsx(CloseCircleOutlined,{}),children:s("Close")},`${uniqueId()}`),e.jsx(Button,{onClick:()=>{window.open(`${DOWNLOAD_BASE_URL}${n}/${n}-${t._id}.pdf`,"_blank")},icon:e.jsx(FilePdfOutlined,{}),children:s("Download PDF")},`${uniqueId()}`),e.jsx(Button,{onClick:()=>{u(erp.convert({entity:n,id:t._id}))},icon:e.jsx(RetweetOutlined,{}),style:{display:n==="quote"?"inline-block":"none"},children:s("Convert to Invoice")},`${uniqueId()}`)],style:{padding:"20px 0px"},children:e.jsxs(Row,{children:[e.jsx(Statistic,{title:"Status",value:t.status}),e.jsx(Statistic,{title:s("SubTotal"),value:a({amount:t.subTotal,currency_code:t.currency}),style:{margin:"0 32px"}}),e.jsx(Statistic,{title:s("Total"),value:a({amount:t.total,currency_code:t.currency}),style:{margin:"0 32px"}}),e.jsx(Statistic,{title:s("Paid"),value:a({amount:t.credit,currency_code:t.currency}),style:{margin:"0 32px"}})]})}),e.jsx(Divider,{dashed:!0}),e.jsxs(Descriptions,{title:`lead : ${t.lead.name}`,children:[e.jsx(Descriptions.Item,{label:s("Address"),children:x.address}),e.jsx(Descriptions.Item,{label:s("email"),children:x.email}),e.jsx(Descriptions.Item,{label:s("Phone"),children:x.phone})]}),e.jsx(Divider,{}),e.jsxs(Row,{gutter:[12,0],children:[e.jsx(Col,{className:"gutter-row",span:11,children:e.jsx("p",{children:e.jsx("strong",{children:s("product")})})}),e.jsx(Col,{className:"gutter-row",span:4,children:e.jsx("p",{style:{textAlign:"right"},children:e.jsx("strong",{children:s("PRICE")})})}),e.jsx(Col,{className:"gutter-row",span:4,children:e.jsx("p",{style:{textAlign:"right"},children:e.jsx("strong",{children:s("QUANTITY")})})}),e.jsx(Col,{className:"gutter-row",span:5,children:e.jsx("p",{style:{textAlign:"right"},children:e.jsx("strong",{children:s("TOTAL")})})}),e.jsx(Divider,{})]}),C.map(o=>e.jsx(Item,{item:o,currentErp:t},o._id)),e.jsx("div",{style:{width:"300px",float:"right",textAlign:"right",fontWeight:"700"},children:e.jsxs(Row,{gutter:[12,-5],children:[e.jsx(Col,{className:"gutter-row",span:12,children:e.jsxs("p",{children:[s("Sub Total")," : "]})}),e.jsx(Col,{className:"gutter-row",span:12,children:e.jsx("p",{children:a({amount:t.subTotal,currency_code:t.currency})})}),e.jsx(Col,{className:"gutter-row",span:12,children:e.jsxs("p",{children:["Tax Total (",t.taxRate," %) :"]})}),e.jsx(Col,{className:"gutter-row",span:12,children:e.jsx("p",{children:a({amount:t.taxTotal,currency_code:t.currency})})}),e.jsx(Col,{className:"gutter-row",span:12,children:e.jsxs("p",{children:[s("Total")," :"]})}),e.jsx(Col,{className:"gutter-row",span:12,children:e.jsx("p",{children:a({amount:t.total,currency_code:t.currency})})})]})})]})}function S({config:r}){const i=N(),{id:s}=_();E(),I.useLayoutEffect(()=>{i(v.read({entity:r.entity,id:s}))},[s]);const{result:n,isSuccess:d,isLoading:u=!0}=L(b);return u?e.jsx(f,{children:e.jsx($,{})}):e.jsx(f,{children:d?e.jsx(R,{config:r,selectedItem:n}):e.jsx(A,{entity:r.entity})})}function F(){const r=D(),i="offer",s={PANEL_TITLE:r("Offer Leads"),DATATABLE_TITLE:r("offer_list"),ADD_NEW_ENTITY:r("add_new_offer"),ENTITY_NAME:r("Offer Leads")},n={entity:i,...s};return e.jsx(S,{config:n})}export{F as default};
